/*!yas-wipe 1.0.0 发布日期:2018-11-13*/
var moveX,moveY,canvas=document.getElementById("cas"),context=canvas.getContext("2d"),_w=canvas.width,_h=canvas.height,t=0,radius=20,isMouseDown=!1,device=/android|webos|iPhone|ipad|ipod|blackberry|iemobile|opera mini/i.test(navigator.userAgent.toLowerCase());console.log(device);var down=device?"touchstart":"mousedown",move=device?"touchmove":"mousemove",up=device?"touchend":"mouseup";function drawMask(e){e.fillStyle="#666",e.fillRect(0,0,_w,_h),e.globalCompositeOperation="destination-out"}function drawZio(e,t,o,n,a){if(console.log("传递的实参个数："+arguments.length),e.save(),e.beginPath(),3===arguments.length)e.arc(t,o,radius,0,2*Math.PI),e.fillStyle="rgba(255,0,0,255)",e.fill();else{if(5!==arguments.length)return!1;e.moveTo(t,o),e.lineTo(n,a),e.lineWidth=2*radius,e.lineCap="round",e.stroke()}e.restore()}function fn1(e){var t=e||window.event;t.preventDefault(),!0===isMouseDown&&(x2=device?t.touches[0].clientX:t.clientX,y2=device?t.touches[0].clientY:t.clientY,drawZio(context,moveX,moveY,x2,y2),moveX=x2,moveY=y2)}function clearRect(e){e.clearRect(0,0,_w,_h)}function getTransparencyPercent(e){for(var o=e.getImageData(0,0,_w,_h),n=0;n<o.data.length;n+=4){0===o.data[n+3]&&t++}var a=t/(_w*_h)*100;return console.log("透明点的个数："+t),console.log("占总面积："+Math.ceil(a)+"%"),Math.round(a)}canvas.addEventListener(down,function(e){var t=e||window.event;moveX=device?t.touches[0].clientX:t.clientX,moveY=device?t.touches[0].clientY:t.clientY,drawZio(context,moveX,moveY),isMouseDown=!0},!1),canvas.addEventListener(move,fn1,!1),canvas.addEventListener(up,function(){isMouseDown=!1,50<getTransparencyPercent(context)&&(alert("超过50%"),clearRect(context))},!1),window.onload=function(){drawMask(context)};